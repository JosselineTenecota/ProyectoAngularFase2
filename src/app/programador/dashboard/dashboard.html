<div class="dash-wrapper">
  <header class="dash-header flex justify-between items-center">
    <div>
      <h1>Panel de Programador</h1>
      <p *ngIf="currentUser">
        Bienvenido, <span style="color: #42a5f5;">{{ currentUser.nombre }}</span> ({{ currentUser.cedula }})
      </p>
    </div>
    <div class="bg-gray-900 px-4 py-2 rounded-lg border border-gray-800">
      <span class="text-xs uppercase tracking-widest text-gray-500">Estado:</span>
      <span class="ml-2 text-green-500 font-mono text-sm">PostgreSQL Online</span>
    </div>
  </header>

  <div class="dash-grid">
    <section class="form-card">
      <h2>üìù Nuevo Proyecto</h2>
      <form (ngSubmit)="addProject()" #projectForm="ngForm">
        <div class="form-group">
          <label>T√≠tulo del Proyecto *</label>
          <input type="text" name="titulo" [(ngModel)]="newProject.titulo" required class="input-dark">
        </div>
        <div class="form-group">
          <label>Descripci√≥n *</label>
          <textarea name="descripcion" [(ngModel)]="newProject.descripcion" required rows="2" class="input-dark"></textarea>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Categor√≠a</label>
            <select name="tipo" [(ngModel)]="newProject.tipo" class="input-dark">
              <option value="Academico">Acad√©mico</option>
              <option value="Laboral">Laboral</option>
            </select>
          </div>
          <div class="form-group">
            <label>Rol</label>
            <select name="participacion" [(ngModel)]="newProject.participacion" class="input-dark">
              <option value="Frontend">Frontend</option>
              <option value="Backend">Backend</option>
              <option value="Fullstack">Fullstack</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label>Stack Tecnol√≥gico</label>
          <input type="text" name="tecnologias" [(ngModel)]="newProject.tecnologias" placeholder="Ej: Angular, Java, JPA" class="input-dark">
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>GitHub URL</label>
            <input type="url" name="urlRepo" [(ngModel)]="newProject.urlRepo" class="input-dark">
          </div>
          <div class="form-group">
            <label>Demo URL</label>
            <input type="url" name="urlDeploy" [(ngModel)]="newProject.urlDeploy" class="input-dark">
          </div>
        </div>

        <button type="submit" [disabled]="!projectForm.valid" class="btn-submit">Guardar Proyecto en BD</button>
      </form>
    </section>

    <section class="projects-list">
      <div class="mb-10">
        <h2 style="color: #ab47bc;">üéì Proyectos Acad√©micos</h2>
        <div *ngIf="(academicos$ | async) as progs; else loadingProjects">
          <div *ngFor="let p of progs" class="project-card">
            <div class="card-header">
              <h3>{{ p.titulo }}</h3>
              <button (click)="deleteProject(p.codigo)" class="btn-delete">üóë</button>
            </div>
            <p class="tech-small"><strong>Stack:</strong> {{ p.tecnologias }}</p>
            <p class="desc">{{ p.descripcion }}</p>
          </div>
          <p *ngIf="progs.length === 0" class="text-gray-600 italic">No hay proyectos acad√©micos.</p>
        </div>
      </div>

      <div>
        <h2 style="color: #66bb6a;">üíº Experiencia Laboral</h2>
        <div *ngIf="(laborales$ | async) as jobs; else loadingProjects">
          <div *ngFor="let p of jobs" class="project-card" style="border-left-color: #66bb6a;">
            <div class="card-header">
              <h3>{{ p.titulo }}</h3>
              <button (click)="deleteProject(p.codigo)" class="btn-delete">üóë</button>
            </div>
            <p class="tech-small"><strong>Stack:</strong> {{ p.tecnologias }}</p>
            <p class="desc">{{ p.descripcion }}</p>
          </div>
          <p *ngIf="jobs.length === 0" class="text-gray-600 italic">No hay experiencia registrada.</p>
        </div>
      </div>
    </section>
  </div>
</div>

<ng-template #loadingProjects>
  <p class="text-gray-500">Cargando proyectos...</p>
</ng-template>