<div class="dash-wrapper wrapper">
  
  <div class="dash-header">
    <h1>Mi Portafolio</h1>
    <p>Bienvenido, gestiona tus proyectos académicos y laborales.</p>
  </div>

  <div class="dash-grid">
    
    <!-- COLUMNA 1: Formulario de Creación -->
    <div class="form-card">
      <h2>Nuevo Proyecto</h2>
      
      <div class="form-group">
        <label>Título del Proyecto</label>
        <input type="text" [(ngModel)]="newProject.titulo" placeholder="Ej: Sistema de Ventas" class="input-dark">
      </div>

      <!-- Tipo: Académico o Laboral -->
      <div class="form-group">
        <label>Tipo de Proyecto</label>
        <select [(ngModel)]="newProject.tipo" class="input-dark">
          <option value="Academico">Académico</option>
          <option value="Laboral">Laboral</option>
        </select>
      </div>

      <!-- NUEVO: Tipo de Participación -->
      <div class="form-group">
        <label>Tipo de Participación</label>
        <select [(ngModel)]="newProject.participacion" class="input-dark">
          <option value="Frontend">Frontend</option>
          <option value="Backend">Backend</option>
          <option value="Base de Datos">Base de Datos</option>
        </select>
      </div>

      <div class="form-group">
        <label>Tecnologías (separadas por coma)</label>
        <input type="text" [(ngModel)]="newProject.tecnologias" placeholder="Angular, Firebase, Sass..." class="input-dark">
      </div>

      <div class="form-group">
        <label>Descripción</label>
        <textarea [(ngModel)]="newProject.descripcion" rows="4" class="input-dark"></textarea>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>URL Repositorio (Git)</label>
          <input type="text" [(ngModel)]="newProject.repoUrl" class="input-dark">
        </div>
        <div class="form-group">
          <label>URL Demo (Deploy)</label>
          <input type="text" [(ngModel)]="newProject.demoUrl" class="input-dark">
        </div>
      </div>

      <button class="btn-submit" (click)="addProject()">Publicar Proyecto</button>
    </div>

    <!-- COLUMNA 2: Lista de mis proyectos -->
    <div class="projects-list">
      <h2>Mis Proyectos Publicados</h2>

      <div class="project-card" *ngFor="let p of projects$ | async">
        <div class="card-header">
          <span class="badge" [class.work]="p.tipo === 'Laboral'">{{ p.tipo }}</span>
          <!-- Opcional: Mostrar participación visualmente -->
          <span style="font-size: 0.8rem; color: #888; margin-left: 10px;">{{ p.participacion }}</span>
          
          <button class="btn-delete" (click)="deleteProject(p.id!)">×</button>
        </div>
        
        <h3>{{ p.titulo }}</h3>
        <p class="tech">{{ p.tecnologias }}</p>
        <p class="desc">{{ p.descripcion }}</p>
        
        <div class="links">
          <a *ngIf="p.repoUrl" [href]="p.repoUrl" target="_blank">Ver Código</a>
          <a *ngIf="p.demoUrl" [href]="p.demoUrl" target="_blank">Ver Demo</a>
        </div>
      </div>

      <div *ngIf="(projects$ | async)?.length === 0" class="empty-state">
        <p>Aún no has subido proyectos.</p>
      </div>
    </div>

  </div>

  <!-- SECCIÓN DE ASESORÍAS (MANTENIDA) -->
  <div class="appointments-section">
    <h2>Solicitudes de Asesoría</h2>
    
    <div class="appointments-grid">
      <div class="appt-card" *ngFor="let cita of asesorias$ | async" [ngClass]="cita.estado.toLowerCase()">
        <div class="appt-header">
          <span class="status-badge" [ngClass]="cita.estado.toLowerCase()">{{ cita.estado }}</span>
          <span class="date">{{ cita.fecha }} - {{ cita.hora }}</span>
        </div>
        <h3>{{ cita.clienteNombre }}</h3>
        <p class="email-client">{{ cita.clienteEmail }}</p>
        <div class="topic-box"><strong>Tema:</strong> {{ cita.tema }}</div>
        <div class="answer-box" *ngIf="cita.respuesta"><strong>Tu respuesta:</strong> {{ cita.respuesta }}</div>
        <div class="actions" *ngIf="cita.estado === 'Pendiente'">
          <button class="btn-action approve" (click)="responderAsesoria(cita.id!, 'Aprobada')">Aprobar</button>
          <button class="btn-action reject" (click)="responderAsesoria(cita.id!, 'Rechazada')">Rechazar</button>
        </div>
      </div>
      <div *ngIf="(asesorias$ | async)?.length === 0" class="empty-state-appt">
        No tienes solicitudes de asesoría pendientes.
      </div>
    </div>
  </div>

</div>