<div class="dash-wrapper wrapper">
  
  <div class="dash-header">
    <h1>Mi Portafolio</h1>
    <p>Bienvenido, gestiona tus proyectos acad√©micos y laborales.</p>
  </div>

  <div class="dash-grid">
    
    <!-- === COLUMNA 1: Formulario de Creaci√≥n === -->
    <div class="form-card">
      <h2>Nuevo Proyecto</h2>
      
      <div class="form-group">
        <label>T√≠tulo del Proyecto</label>
        <input type="text" [(ngModel)]="newProject.titulo" placeholder="Ej: Sistema de Ventas" class="input-dark">
      </div>

      <!-- Combo: Acad√©mico o Laboral -->
      <div class="form-group">
        <label>Tipo de Proyecto</label>
        <select [(ngModel)]="newProject.tipo" class="input-dark">
          <option value="Academico">Acad√©mico</option>
          <option value="Laboral">Laboral</option>
        </select>
      </div>

      <!-- Combo: Frontend, Backend, Base de Datos -->
      <div class="form-group">
        <label>Tipo de Participaci√≥n</label>
        <select [(ngModel)]="newProject.participacion" class="input-dark">
          <option value="Frontend">Frontend</option>
          <option value="Backend">Backend</option>
          <option value="Base de Datos">Base de Datos</option>
        </select>
      </div>

      <div class="form-group">
        <label>Tecnolog√≠as (separadas por coma)</label>
        <input type="text" [(ngModel)]="newProject.tecnologias" placeholder="Angular, Firebase, Sass..." class="input-dark">
      </div>

      <div class="form-group">
        <label>Descripci√≥n</label>
        <textarea [(ngModel)]="newProject.descripcion" rows="4" class="input-dark"></textarea>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>URL Repositorio (Git)</label>
          <input type="text" [(ngModel)]="newProject.repoUrl" class="input-dark">
        </div>
        <div class="form-group">
          <label>URL Demo (Deploy)</label>
          <input type="text" [(ngModel)]="newProject.demoUrl" class="input-dark">
        </div>
      </div>

      <button class="btn-submit" (click)="addProject()">Publicar Proyecto</button>
    </div>

    <!-- === COLUMNA 2: Lista de mis proyectos === -->
    <div class="projects-list">
      <h2>Mis Proyectos Publicados</h2>

      <div class="project-card" *ngFor="let p of projects$ | async">
        <div class="card-header">
          <div>
            <!-- Badge 1: Acad√©mico/Laboral -->
            <span class="badge" [class.work]="p.tipo === 'Laboral'">{{ p.tipo }}</span>
            
            <!-- Badge 2: Participaci√≥n (NUEVO) -->
            <!-- Aqu√≠ es donde se muestra si es Frontend, Backend, etc. -->
            <span style="font-size: 0.8rem; color: #aaa; margin-left: 8px; font-weight: 600; text-transform: uppercase; border: 1px solid #444; padding: 2px 6px; border-radius: 4px;">
               {{ p.participacion }}
            </span>
          </div>

          <button class="btn-delete" (click)="deleteProject(p.id!)">√ó</button>
        </div>
        
        <h3>{{ p.titulo }}</h3>
        <p class="tech">{{ p.tecnologias }}</p>
        <p class="desc">{{ p.descripcion }}</p>
        
        <div class="links">
          <a *ngIf="p.repoUrl" [href]="p.repoUrl" target="_blank">Ver C√≥digo</a>
          <a *ngIf="p.demoUrl" [href]="p.demoUrl" target="_blank">Ver Demo</a>
        </div>
      </div>

      <!-- Mensaje si no hay proyectos -->
      <div *ngIf="(projects$ | async)?.length === 0" class="empty-state">
        <p>A√∫n no has subido proyectos.</p>
      </div>
    </div>

  </div>

  <!-- SECCI√ìN DE ASESOR√çAS (PROGRAMADOR) -->
  <div class="appointments-section">
    <h2>Solicitudes de Asesor√≠a Recibidas</h2>
    
    <div class="appointments-grid">
      <div class="appt-card" *ngFor="let cita of asesorias$ | async" [ngClass]="cita.estado.toLowerCase()">
        
        <div class="appt-header">
          <!-- Badge de Estado -->
          <span class="status-badge" [ngClass]="cita.estado.toLowerCase()">{{ cita.estado }}</span>
          <!-- Fecha -->
          <span class="date">üìÖ {{ cita.fecha }} | üïí {{ cita.hora }}</span>
        </div>

        <div class="appt-body">
          <h3>üë§ {{ cita.clienteNombre }}</h3>
          <span class="email-client">‚úâÔ∏è {{ cita.clienteEmail }}</span>
          
          <div class="topic-box">
            <strong>Tema:</strong> {{ cita.tema }}
          </div>

          <!-- Muestra tu respuesta si ya respondiste -->
          <div class="answer-box" *ngIf="cita.respuesta">
            <strong>Tu respuesta:</strong> {{ cita.respuesta }}
          </div>

          <!-- BOTONES (Solo visibles si est√° PENDIENTE) -->
          <div class="actions" *ngIf="cita.estado === 'Pendiente'">
            <button class="btn-action approve" (click)="responderAsesoria(cita, 'Aprobada')">Aprobar</button>
            <button class="btn-action reject" (click)="responderAsesoria(cita, 'Rechazada')">Rechazar</button>
          </div>
        </div>

      </div>

      <!-- Mensaje vacio -->
      <div *ngIf="(asesorias$ | async)?.length === 0" class="empty-state-appt">
        No tienes solicitudes pendientes.
      </div>
    </div>
  </div>

</div>